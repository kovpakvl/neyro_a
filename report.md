## Отчет о проделанной работе
Работа выполнена в рамках конкурсного задания по разработке нейросетевой модели определения направления взгляда пользователя на экране с последующей визуализацией результата. Целью являлось построение полного решения, включающего обучение модели на предоставленных данных, оценку качества, сохранение артефактов, создание API для интеграции и разработку простого графического интерфейса для демонстрации работы системы.

В ходе выполнения задания реализована модель регрессии углов взгляда по набору числовых признаков, предусмотрена групповая кросс валидация, построены графики сравнения качества на обучающих и проверочных выборках, а также сформированы артефакты для последующего использования без повторного обучения. Для интеграции модели в внешние системы разработан HTTP API, принимающий изображение лица в формате base64 и возвращающий прогноз углов и зону взгляда. Для визуальной демонстрации создано легковесное графическое приложение, отображающее видеопоток, текстовое направление и координаты взгляда, а также точку на координатной сетке.

## Использованные скрипты и их назначение
Скрипт `train.py` отвечает за подготовку данных, подбор параметров модели, обучение и сохранение артефактов. В нем реализована стандартизация признаков, групповой подбор гиперпараметров и оценка качества по метрике средней абсолютной ошибки. Такой подход выбран для обеспечения стабильной сходимости, корректного разделения данных по пользователям и укладывания в конкурсные ограничения по времени обучения. Итогом работы скрипта являются файлы моделей и график качества.

Скрипт `api.py` поднимает HTTP API и обеспечивает доступ к обученной модели. Он загружает артефакты, выполняет детекцию лица через MediaPipe, извлекает признаки и возвращает прогноз углов. Стиль реализации соответствует промышленным требованиям к прикладному API: компактная структура, четкие маршруты и предсказуемая обработка ошибок, что важно для интеграции в другие информационные системы.

Скрипт `app_api_client_simple.py` реализует графическое приложение для визуализации работы модели. Приложение подключается к API, получает кадры с камеры и отображает направление взгляда в текстовой форме и на координатной сетке. Стиль реализации ориентирован на простоту и наглядность, чтобы приложение могло быть использовано в качестве демонстрационного инструмента и средства проверки корректности работы API.

## Оценка качества и визуализация
Для оценки качества использована групповая кросс валидация, что исключает утечку данных между обучением и проверкой за счет разбиения по идентификатору пользователя. Метрика качества представлена средней абсолютной ошибкой углов в градусах. По результатам получены графики сравнения ошибок для обучающей и проверочной выборок, что позволяет оценить устойчивость модели и отсутствие переобучения.

Ниже приведен график `quality_cv.png`, сформированный в ходе обучения. По оси X отображены фолды кросс валидации в диапазоне 1.0–5.0, по оси Y показана средняя абсолютная ошибка в градусах в диапазоне 2.5–6.0. Линии `H train` и `H val` отражают ошибки для горизонтального угла на обучающей и проверочной выборках, линии `V train` и `V val` показывают аналогичные ошибки для вертикального угла. Назначение линий состоит в сравнении устойчивости модели между обучением и проверкой и в контроле переобучения. Полученный результат показывает близкие уровни ошибок между train и val, что говорит о корректной обобщающей способности модели при сохранении приемлемой точности в конкурсных ограничениях по времени.

![График качества по кросс валидации](out/models/quality_cv.png)

## Итоговый результат
В результате работы создана полная цепочка решения задачи: подготовка данных, обучение модели, оценка качества, сохранение артефактов, запуск API и визуализация в графическом интерфейсе. Документация на API и руководство пользователя подготовлены отдельно, что обеспечивает возможность дальнейшей интеграции и использования решения в прикладных системах.

